--- Starting BFV Demo

--- Parameters:
n    : 4
q    : 134217689
t    : 16
T    : 0
l    : 0
p    : 0
mu   : 0
sigma: 1.6

--- Random integers n1 and n2 are generated.
* n1: 1

--- n1 is encoded as polynomial m1(x).
* m1(x): 1 + 0*x^1 + 0*x^2 + 0*x^3

* dm: 8388605 + 0*x^1 + 0*x^2 + 0*x^3
* a: 107473724 + 548062*x^1 + 50708536*x^2 + 95944201*x^3
* s: 1 + 1*x^1 + 0*x^2 + 0*x^3
* e: 0 + 0*x^1 + 0*x^2 + 0*x^3

1

as: [11529523, 108021786, 51256598, 12435048]
-as + dm + e: [131076771, 26195903, 82961091, 121782641]

* p: 18014388040500722

* b: 394684107553993832398657 + 1004388028707295381409838*x^1 + 1647535671544082368115416*x^2 + 1794329093638495272071917*x^3
* s': 134217688 + 0*x^1 + 0*x^2 + 134217688*x^3
* e': 134217688 + 0*x^1 + 134217688*x^2 + 134217687*x^3
* -bs': [2394511955049824680448198, 1323821558816184324893876, 1277806234317375239100080, 1037370199752092436848642]
* Ps: [18014388040500722, 18014388040500722, 0, 0]
* -bs' + Ps: [2394511973064212720948920, 1323821576830572365394598, 1277806234317375239100080, 1037370199752092436848642]
* -bs' + Ps + e' premod: [2394511973064212855166608, 1323821576830572365394598, 1277806234317375373317768, 1037370199752092571066329]
* -bs' + Ps + e': [2394511973064212855166608, 1323821576830572365394598, 1277806234317375373317768, 1037370199752092571066329]

a*b nomod: [64969888831905672800882014909948, -31613246509340290039024974291064, 159948672485678594496957730354867, 409058947701242983561190364533548]
-a*b*s' nomod: [64969888624208364011671330821592, -31613248455286640261121665237692, 159948671562322340135556023559318, 409058945059383644665849534453102]
a(-b*s' + P*s + e'): [64969888831905672800882014909948, -31613246509340290039024974291064, 159948672485678594496957730354867, 409058947701242983561190364533548]
P^-1 above

* c1*ksh0: [64969888831905672800882014909948, -31613246509340290039024974291064, 159948672485678594496957730354867, 409058947701242983561190364533548]
* P^-1*c1*ksh0: [3606555420358304, -1754888727736187, 8878940107544875, 22707346304608244]

* c0 + (P^-1 * c1 * ksh0) premod: [3606555551435075, -1754888701540284, 8878940190505966, 22707346426390885]
* c0 + (P^-1 * c1 * ksh0): [83377415, 65944132, 97571424, 114358378]
* c1*ksh1: [-138474561569337247345789743426600, -140897661918364230000822328836682, 25475643011802696458176431695975, 282544879328430513436067747247925]
* P^-1*c1*ksh1 premod: [-7686886796154984, -7821395964247692, 1414183093787436, 15684400640932180]

* P^-1*c1*ksh1: [99885259, 7395370, 24251204, 6096855]
P^-1*a*b*s'[12413779064956632, -2262351068791792, 2436634749925112, 14224674310432432]
result: [41727800, 16855834, 116063340, 28235575]
result * -1: [92489889, 117361855, 18154349, 105982114]

-P^-1*a*b*s' + dm + e + P^-1*a*e': [100878494, 117361854, 18154349, 105982116]
c0 + c1s: 8388605, 134217688, 0, 2
dm + e + P^-1*a*e': 8388605 + -1*x^1 + 0*x^2 + 2*x^3



15 + 10*x^1 + 9*x^2 + 1*x^3
-33
